<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç¨‹å¼ç¢¼é †åºæ’åˆ—å·¥å…·</title>
  <style>
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }

      body {
          font-family: 'Microsoft JhengHei', Arial, sans-serif;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          min-height: 100vh;
          padding: 20px;
      }

      .container {
          max-width: 1200px;
          margin: 0 auto;
          background: white;
          border-radius: 15px;
          box-shadow: 0 10px 30px rgba(0,0,0,0.3);
          overflow: hidden;
      }

      .header {
          background: linear-gradient(135deg, #4CAF50, #45a049);
          color: white;
          padding: 20px;
          text-align: center;
      }

      .header h1 {
          margin: 0;
          font-size: 24px;
      }

      .header p {
          margin: 10px 0 0 0;
          opacity: 0.9;
      }

      .main-content {
          display: flex;
          height: 70vh;
      }

      .input-section, .output-section {
          flex: 1;
          padding: 20px;
          display: flex;
          flex-direction: column;
      }

      .input-section {
          border-right: 2px solid #eee;
      }

      .section-title {
          font-size: 18px;
          font-weight: bold;
          margin-bottom: 15px;
          color: #333;
          display: flex;
          align-items: center;
          gap: 10px;
      }

      .textarea {
          flex: 1;
          border: 2px solid #ddd;
          border-radius: 8px;
          padding: 15px;
          font-family: 'Consolas', 'Monaco', monospace;
          font-size: 14px;
          resize: none;
          outline: none;
          transition: border-color 0.3s;
      }

      .textarea:focus {
          border-color: #4CAF50;
      }

      .input-textarea {
          background: #f9f9f9;
      }

      .output-textarea {
          background: #f0f8f0;
          color: #2d5a2d;
      }

      .controls {
          display: flex;
          gap: 10px;
          margin: 15px 20px;
          justify-content: center;
      }

      .btn {
          padding: 12px 24px;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          font-size: 16px;
          font-weight: bold;
          transition: all 0.3s;
          display: flex;
          align-items: center;
          gap: 8px;
      }

      .btn-primary {
          background: linear-gradient(135deg, #4CAF50, #45a049);
          color: white;
      }

      .btn-primary:hover {
          background: linear-gradient(135deg, #45a049, #3d8b40);
          transform: translateY(-2px);
      }

      .btn-secondary {
          background: linear-gradient(135deg, #2196F3, #1976D2);
          color: white;
      }

      .btn-secondary:hover {
          background: linear-gradient(135deg, #1976D2, #1565C0);
          transform: translateY(-2px);
      }

      .btn-clear {
          background: linear-gradient(135deg, #f44336, #d32f2f);
          color: white;
      }

      .btn-clear:hover {
          background: linear-gradient(135deg, #d32f2f, #c62828);
          transform: translateY(-2px);
      }

      .stats {
          background: #f5f5f5;
          padding: 15px 20px;
          border-top: 1px solid #ddd;
          display: flex;
          justify-content: space-between;
          font-size: 14px;
          color: #666;
      }

      .example {
          background: #e8f5e8;
          margin: 10px 20px;
          padding: 15px;
          border-radius: 8px;
          border-left: 4px solid #4CAF50;
      }

      .example h3 {
          margin: 0 0 10px 0;
          color: #2d5a2d;
      }

      .example code {
          background: #d4edda;
          padding: 2px 6px;
          border-radius: 4px;
          font-family: monospace;
      }

      @media (max-width: 768px) {
          .main-content {
              flex-direction: column;
              height: auto;
          }
          
          .input-section {
              border-right: none;
              border-bottom: 2px solid #eee;
          }
          
          .textarea {
              height: 300px;
          }
          
          .controls {
              flex-wrap: wrap;
          }
      }
  </style>
</head>
<body>
  <div class="container">
      <div class="header">
          <h1>ğŸ”§ ç¨‹å¼ç¢¼é †åºæ’åˆ—å·¥å…·</h1>
          <p>è‡ªå‹•ç§»é™¤ç¨‹å¼ç¢¼å…§å®¹ï¼Œä¿ç•™ä¸­æ–‡è¨»é‡‹å’Œçµæ§‹æ¨™ç±¤ï¼Œæ–¹ä¾¿æª¢æŸ¥ç¨‹å¼é †åº</p>
      </div>

      <div class="example">
          <h3>ğŸ“ ä½¿ç”¨èªªæ˜ï¼š</h3>
          <p>1. å°‡å®Œæ•´çš„ HTML ç¨‹å¼ç¢¼è²¼åˆ°å·¦å´è¼¸å…¥æ¡†</p>
          <p>2. é»æ“Šã€Œåˆ†æç¨‹å¼çµæ§‹ã€æŒ‰éˆ•</p>
          <p>3. å³å´æœƒé¡¯ç¤ºåªä¿ç•™ä¸­æ–‡è¨»é‡‹çš„ç‰ˆæœ¬ï¼š</p>
          <p>â€¢ <code>// éŠæˆ²ç‹€æ…‹ç®¡ç†</code>ï¼ˆJS è¨»é‡‹ï¼‰</p>
          <p>â€¢ <code>/* æˆ°é¬¥ä¸­å¤®å€åŸŸ */</code>ï¼ˆCSS è¨»é‡‹ï¼‰</p>
          <p>â€¢ <code>&lt;!-- èƒŒåŒ…ç³»çµ±å½ˆçª— --&gt;</code>ï¼ˆHTML è¨»é‡‹ï¼‰</p>
          <p>4. è¤‡è£½å³å´çµæœï¼Œå°±å¯ä»¥æ–¹ä¾¿åœ°æª¢æŸ¥ç¨‹å¼é †åºäº†ï¼</p>
      </div>

      <div class="main-content">
          <div class="input-section">
              <div class="section-title">
                  ğŸ“¥ è¼¸å…¥å®Œæ•´ç¨‹å¼ç¢¼
              </div>
              <textarea 
                  id="inputCode" 
                  class="textarea input-textarea" 
                  placeholder="è«‹è²¼ä¸Šä½ çš„å®Œæ•´ HTML ç¨‹å¼ç¢¼...

ä¾‹å¦‚ï¼š
<!DOCTYPE html>
<html>
<head>
  <style>
      /* æˆ°é¬¥ä¸­å¤®å€åŸŸ */
      .battle-area { 
          width: 100%; 
          height: 400px; 
      }
      
      /* ç©å®¶è³‡è¨Šå€åŸŸ */
      .player-info { margin: 10px; }
  </style>
</head>
<body>
  <!-- èƒŒåŒ…ç³»çµ±å½ˆçª— -->
  <div>å…§å®¹</div>
  
  <script>
      // éŠæˆ²ç‹€æ…‹ç®¡ç†
      const gameState = { ... };
      
      // åˆå§‹åŒ–éŠæˆ²
      function initGame() { ... }
  </script>
</body>
</html>"></textarea>
          </div>

          <div class="output-section">
              <div class="section-title">
                  ğŸ“¤ ç¨‹å¼çµæ§‹é †åº
              </div>
              <textarea 
                  id="outputCode" 
                  class="textarea output-textarea" 
                  readonly 
                  placeholder="åˆ†æçµæœæœƒé¡¯ç¤ºåœ¨é€™è£¡...

åªæœƒä¿ç•™ï¼š
â€¢ HTML çµæ§‹æ¨™ç±¤ (<!DOCTYPE>, <html>, <head>, <body>, </script>, </body>, </html>)
â€¢ ä¸­æ–‡è¨»é‡‹ï¼š
- // ä¸­æ–‡è¨»é‡‹ (JavaScript)
- /* æˆ°é¬¥ä¸­å¤®å€åŸŸ */ (CSS)
- <!-- èƒŒåŒ…ç³»çµ±å½ˆçª— --> (HTML)
â€¢ å‡½æ•¸åç¨±è¡Œ
â€¢ é‡è¦çš„ç¨‹å¼å€å¡Šæ¨™ç¤º

ç§»é™¤ï¼š
â€¢ å…·é«”çš„ç¨‹å¼ç¢¼å¯¦ä½œ
â€¢ è‹±æ–‡è¨»é‡‹
â€¢ CSS è©³ç´°å…§å®¹
â€¢ JavaScript å¯¦ä½œç´°ç¯€"></textarea>
          </div>
      </div>

      <div class="controls">
          <button class="btn btn-primary" onclick="analyzeCode()">
              ğŸ” åˆ†æç¨‹å¼çµæ§‹
          </button>
          <button class="btn btn-secondary" onclick="copyOutput()">
              ğŸ“‹ è¤‡è£½çµæœ
          </button>
          <button class="btn btn-clear" onclick="clearAll()">
              ğŸ—‘ï¸ æ¸…ç©ºå…¨éƒ¨
          </button>
      </div>

      <div class="stats">
          <span id="inputStats">è¼¸å…¥ï¼š0 è¡Œ</span>
          <span id="outputStats">è¼¸å‡ºï¼š0 è¡Œ</span>
          <span id="reductionStats">ç²¾ç°¡ï¼š0%</span>
      </div>
  </div>

  <script>
      function analyzeCode() {
          const input = document.getElementById('inputCode').value;
          if (!input.trim()) {
              alert('è«‹å…ˆè¼¸å…¥ç¨‹å¼ç¢¼ï¼');
              return;
          }

          const lines = input.split('\n');
          const result = [];
          let inScript = false;
          let inStyle = false;

          for (let line of lines) {
              const trimmed = line.trim();
              
              // ä¿ç•™ HTML çµæ§‹æ¨™ç±¤
              if (trimmed.match(/^<!DOCTYPE|^<html|^<head|^<\/head>|^<body|^<\/body>|^<\/html>|^<script|^<\/script>|^<style|^<\/style>/i)) {
                  result.push(line);
                  if (trimmed.match(/<script/i)) inScript = true;
                  if (trimmed.match(/<\/script>/i)) inScript = false;
                  if (trimmed.match(/<style/i)) inStyle = true;
                  if (trimmed.match(/<\/style>/i)) inStyle = false;
                  continue;
              }

              // ä¿ç•™æ‰€æœ‰åŒ…å«ä¸­æ–‡çš„ HTML è¨»é‡‹
              if (trimmed.match(/<!--.*[\u4e00-\u9fff].*-->/) ||
                  trimmed.match(/<!--[\s]*[\u4e00-\u9fff]/) ||
                  trimmed.match(/^<!--.*[\u4e00-\u9fff]/)) {
                  result.push(line);
                  continue;
              }

              // åœ¨ script æ¨™ç±¤å…§
              if (inScript) {
                  // ä¿ç•™ä¸­æ–‡è¨»é‡‹
                  if (trimmed.match(/^\/\/.*[\u4e00-\u9fff]/) || 
                      trimmed.match(/^\/\*.*[\u4e00-\u9fff]/) ||
                      trimmed.match(/\*\/.*[\u4e00-\u9fff]/)) {
                      result.push(line);
                      continue;
                  }
                  
                  // ä¿ç•™å‡½æ•¸å®šç¾©è¡Œï¼ˆåªä¿ç•™å‡½æ•¸åï¼Œç§»é™¤å…§å®¹ï¼‰
                  if (trimmed.match(/^function\s+\w+\s*\(/)) {
                      result.push(line.replace(/\{[\s\S]*$/, ''));
                      continue;
                  }
                  
                  // ä¿ç•™è®Šæ•¸å®£å‘Šè¡Œï¼ˆåªä¿ç•™å®£å‘Šï¼Œç§»é™¤å€¼ï¼‰
                  if (trimmed.match(/^(const|let|var)\s+\w+/)) {
                      const match = trimmed.match(/^(const|let|var)\s+\w+/);
                      result.push(line.substring(0, line.indexOf(match[0]) + match[0].length) + ';');
                      continue;
                  }
                  
                  // ä¿ç•™äº‹ä»¶ç›£è½å™¨ï¼ˆç°¡åŒ–ç‰ˆï¼‰
                  if (trimmed.match(/addEventListener\s*\(/) || 
                      trimmed.match(/window\.addEventListener/) ||
                      trimmed.match(/document\.addEventListener/)) {
                      result.push(line.replace(/\{[\s\S]*$/, ''));
                      continue;
                  }
                  
                  // ä¿ç•™é‡è¦çš„ç¨‹å¼å€å¡Šè¨»é‡‹
                  if (trimmed.match(/^\/\/\s*={3,}/) || 
                      trimmed.match(/^\/\*\s*={3,}/)) {
                      result.push(line);
                      continue;
                  }
              }

              // åœ¨ style æ¨™ç±¤å…§ - ä¿ç•™ä¸­æ–‡è¨»é‡‹ï¼ˆæ”¹é€²ç‰ˆï¼‰
              if (inStyle) {
                  // ä¿ç•™å–®è¡Œä¸­æ–‡ CSS è¨»é‡‹ /* æˆ°é¬¥ä¸­å¤®å€åŸŸ */
                  if (trimmed.match(/\/\*.*[\u4e00-\u9fff].*\*\//) ||
                      trimmed.match(/^\/\*.*[\u4e00-\u9fff]/) ||
                      trimmed.match(/\/\*[\s]*[\u4e00-\u9fff]/)) {
                      result.push(line);
                      continue;
                  }
                  
                  // ä¿ç•™å¤šè¡Œè¨»é‡‹çš„çµå°¾ï¼ˆå¦‚æœåŒ…å«ä¸­æ–‡ï¼‰
                  if (trimmed.match(/.*[\u4e00-\u9fff].*\*\//)) {
                      result.push(line);
                      continue;
                  }
              }

              // åœ¨ä»»ä½•åœ°æ–¹éƒ½ä¿ç•™ç¨ç«‹çš„ä¸­æ–‡ CSS è¨»é‡‹ï¼ˆä¸åœ¨ style æ¨™ç±¤å…§çš„æƒ…æ³ï¼‰
              if (trimmed.match(/^\/\*.*[\u4e00-\u9fff].*\*\//)) {
                  result.push(line);
                  continue;
              }

              // ä¿ç•™ç©ºè¡Œï¼ˆä½†é™åˆ¶é€£çºŒç©ºè¡Œï¼‰
              if (trimmed === '' && result[result.length - 1] !== '') {
                  result.push('');
              }
          }

          // ç§»é™¤çµå°¾å¤šé¤˜çš„ç©ºè¡Œ
          while (result.length > 0 && result[result.length - 1].trim() === '') {
              result.pop();
          }

          document.getElementById('outputCode').value = result.join('\n');
          updateStats(lines.length, result.length);
      }

      function copyOutput() {
          const output = document.getElementById('outputCode');
          if (!output.value.trim()) {
              alert('æ²’æœ‰å…§å®¹å¯ä»¥è¤‡è£½ï¼è«‹å…ˆåˆ†æç¨‹å¼ç¢¼ã€‚');
              return;
          }
          
          output.select();
          document.execCommand('copy');
          
          // è¦–è¦ºåé¥‹
          const btn = event.target;
          const originalText = btn.innerHTML;
          btn.innerHTML = 'âœ… å·²è¤‡è£½ï¼';
          btn.style.background = 'linear-gradient(135deg, #4CAF50, #45a049)';
          
          setTimeout(() => {
              btn.innerHTML = originalText;
              btn.style.background = 'linear-gradient(135deg, #2196F3, #1976D2)';
          }, 2000);
      }

      function clearAll() {
          if (confirm('ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰å…§å®¹å—ï¼Ÿ')) {
              document.getElementById('inputCode').value = '';
              document.getElementById('outputCode').value = '';
              updateStats(0, 0);
          }
      }

      function updateStats(inputLines, outputLines) {
          document.getElementById('inputStats').textContent = `è¼¸å…¥ï¼š${inputLines} è¡Œ`;
          document.getElementById('outputStats').textContent = `è¼¸å‡ºï¼š${outputLines} è¡Œ`;
          
          const reduction = inputLines > 0 ? Math.round((1 - outputLines / inputLines) * 100) : 0;
          document.getElementById('reductionStats').textContent = `ç²¾ç°¡ï¼š${reduction}%`;
      }

      // åˆå§‹åŒ–
      document.addEventListener('DOMContentLoaded', function() {
          updateStats(0, 0);
      });
  </script>
</body>
</html>